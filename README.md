# Mopro React Native Package

This library exposes the native Rust bindings generated by [Mopro](https://github.com/zkmopro/mopro). You get cross-platform mobile proving and verification with a slim, type‑safe JS/TS API.

> Mopro handles circuit compilation, Rust ↔︎ mobile bindings, and multi‑proof back‑ends so you can focus on building privacy‑preserving features.

## How to Import the Package

Use a Node.js package manager in your React Native app to install dependencies. For example:

```sh
# npm
npm install https://github.com/zkmopro/mopro-react-native-package
# yarn / pnpm
yarn add https://github.com/zkmopro/mopro-react-native-package
```

Alternatively, you can manually add it to your package.json:

```json
"dependencies": {
 "mopro-react-native-package": "github:zkmopro/mopro-react-native-package",
}
```

## How to Use the Package

Here is an example of how to integrate and use this package

```ts
import MoproReactNativePackage, { Result } from "mopro-react-native-package";

const circuitInputs = {
    a: [a],
    b: [b],
};

const proofResult: CircomProofResult =
    MoproReactNativePackage.generateCircomProof(
        ZKEY_PATH,
        JSON.stringify(circuitInputs)
    );

const isValid: boolean = await MoproReactNativePackage.verifyProof(
    ZKEY_PATH,
    parsedProofResult
);

console.log("Proof verification result:", isValid);
```

> [!WARNING]  
> The default bindings are built specifically for the `multiplier2` circom circuit. If you'd like to update the circuit or switch to a different proving scheme, please refer to the [How to Build the Package](#how-to-build-the-package) section.<br/>
> Circuit source code: https://github.com/zkmopro/circuit-registry/tree/main/multiplier2<br/>
> Example .zkey file for the circuit: http://ci-keys.zkmopro.org/multiplier2_final.zkey<br/>

## Running on a real device

Since this is a native module, you'll need to use Expo's build commands to run it on a device. Notice that, it is not available for Web yet.
We've included an example app in the example folder to help you get started and test:

```sh
cd example
```

### iOS

To run on a connected iOS simulator:

```sh
npm run ios:device
```

To run on a connected iOS device:

```sh
npm run ios
```

### Android

Set the `ANDROID_HOME` environment variable.

```sh
export ANDROID_HOME=~/Library/Android/sdk/
```

To run on Android emulator/device (if connected):

```sh
npm run android
```

## How to Build the Package

### iOS

- Follow the instructions in the [`mopro-swift-package` README](https://github.com/zkmopro/mopro-swift-package?tab=readme-ov-file#how-to-build-the-package) to build the package.
- Copy the bindings to the path `ios/MoproiOSBindings`.
- Then define the native module API in [ios/MoproReactNativePackageModule.swift](ios/MoproReactNativePackageModule.swift) to match the React Native type. Please refer to [Expo - Argument Types](https://docs.expo.dev/modules/module-api/#argument-types)

### Android

- Follow the instructions in the [`mopro-kotlin-package` README](https://github.com/zkmopro/mopro-kotlin-package?tab=readme-ov-file#how-to-build-the-package) to build the package, then run `npm run android` again.
- Copy the `jniLibs` folder to [`android/src/main/jniLibs`](android/src/main/jniLibs) and copy the `uniffi` folder to [`android/src/main/java/uniffi`](android/src/main/java/uniffi).
- Then define the native module API in [android/src/main/java/expo/modules/moproreactnativepackage/MoproReactNativePackageModule.kt](android/src/main/java/expo/modules/moproreactnativepackage/MoproReactNativePackageModule.kt) to match the React Native type. Please refer to [Expo - Argument Types](https://docs.expo.dev/modules/module-api/#argument-types)

## React Native Module

- Define React Native's module APIs to pass messages between React Native and your desired platforms.
    - [`src/MoproReactNativePackageModule.ts`](src/MoproReactNativePackageModule.ts)
    - [`src/MoproReactNativePackageView.tsx`](src/MoproReactNativePackageView.tsx)
    - [`src/MoproReactNativePackage.types.ts`](src/MoproReactNativePackage.types.ts)

## React Native Example App

- Open the example app that uses the defined flutter package in the [`example/`](example) folder

    ```sh
    cd example
    ```

- Install the dependencies
    ```sh
    npm install
    ```
- Run on iOS simulator
    ```sh
    npm run ios
    ```
    Run on iOS device
    ```sh
    npm run ios:device
    ```
- Run on Android emulator/device (if connected)
  Set the `ANDROID_HOME` environment variable.

    ```sh
    export ANDROID_HOME=~/Library/Android/sdk/
    ```

    Run on Android emulator/device (if connected)

    ```sh
    npm run android
    ```

## Community

- X account: <a href="https://twitter.com/zkmopro"><img src="https://img.shields.io/twitter/follow/zkmopro?style=flat-square&logo=x&label=zkmopro"></a>
- Telegram group: <a href="https://t.me/zkmopro"><img src="https://img.shields.io/badge/telegram-@zkmopro-blue.svg?style=flat-square&logo=telegram"></a>

## Acknowledgements

This work was initially sponsored by a joint grant from [PSE](https://pse.dev/) and [0xPARC](https://0xparc.org/). It is currently incubated by PSE.

This project is heavily inspired by [ezkl-swift-package](https://github.com/zkonduit/ezkl-swift-package) and follows a similar approach for integrating native cryptographic libraries into Swift via a Swift Package.
